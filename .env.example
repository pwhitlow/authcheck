# AuthCheck Environment Variables
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to git (it's in .gitignore)

# ============================================
# OKTA CONFIGURATION
# ============================================

# Your Okta organization URL
# Format: https://yourorgname.okta.com
# Where to find: Log in to Okta Admin Console, look at URL or Settings
OKTA_ORG_URL=https://dev-12345678.okta.com

# OPTION 1A: OAuth2 with Private Key JWT (Most Secure - Recommended)
# Use this if Okta requires private_key_jwt authentication method
# Create a public/private key pair in Okta and download the private key
# Go to: Applications → [Your App] → Credentials → Public Keys → Add a Key

# Client ID
# Where to find: App Integration → General tab
OKTA_CLIENT_ID=0oa1234567890abcdefgh

# Private Key (PEM format)
# Where to find: Download when creating the key pair in Okta, or export from Okta
# The key should start with "-----BEGIN PRIVATE KEY-----" and end with "-----END PRIVATE KEY-----"
# Format: Put entire key on one line with newlines escaped as \n (see example below)
# Or: Use the key exactly as downloaded, with actual newlines (the dotenv library will parse it)
# OKTA_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKc...[rest of key with \n between each line]...-----END PRIVATE KEY-----"

# OPTION 1B: OAuth2 with Client Secret (If DPoP and private_key_jwt are not required)
# Create an API service app with OAuth2 in Okta
# Go to: Applications → Create App Integration → API Services
# Configure with Client Credentials grant type and okta.users.read scope

# Client Secret
# Where to find: App Integration → Client Credentials section
# IMPORTANT: Copy immediately after creation, you won't see it again!
# OKTA_CLIENT_SECRET=abcDEF1234567890ghijklmNOPQRS_tuvwxyz1234

# OPTION 1C: OAuth2 with Private Key JWT (Alternative JWK format)
# If you have the private key in JWK format instead of PEM:
# OKTA_PRIVATE_KEY={"kty":"RSA","kid":"...","use":"sig","alg":"RS256","n":"...","e":"...","d":"...","p":"...","q":"...","dp":"...","dq":"...","qi":"..."}

# OPTION 2: API Token (Legacy)
# Create an API token directly (if OAuth2 is not available)
# Go to: Security → API → Tokens → Create Token

# Okta API Token
# Where to get: Admin Console → Security → API → Tokens → Create Token
# IMPORTANT: Copy immediately after creation, you won't see it again!
# OKTA_API_TOKEN=00abcDEF1234567890ghijklmNOPQRS_tuvwxyz

# Optional: Request timeout in seconds (default: 10)
# OKTA_TIMEOUT=10

# ============================================
# ACTIVE DIRECTORY / LDAP CONFIGURATION
# ============================================

# AD Server hostname or IP
# Examples: dc1.example.com, 192.168.1.50
AD_SERVER=dc1.example.com

# LDAP port (default: 389, use 636 for LDAPS)
AD_PORT=389

# Base Distinguished Name
# Format: DC=example,DC=com or OU=Users,DC=example,DC=com
AD_BASE_DN=OU=Users,DC=example,DC=com

# Service account Distinguished Name
# Format: CN=ServiceAccount,OU=Services,DC=example,DC=com
AD_BIND_DN=CN=AuthCheck,OU=Services,DC=example,DC=com

# Service account password
AD_BIND_PASSWORD=your_service_account_password

# Use SSL/TLS for LDAP? (default: false)
# Set to true if using LDAPS (port 636)
AD_USE_SSL=false

# Optional: Request timeout in seconds (default: 10)
# AD_TIMEOUT=10

# ============================================
# RADIUS CONFIGURATION
# ============================================

# RADIUS server hostname or IP
RADIUS_SERVER=radius.example.com

# RADIUS server port (default: 1812)
RADIUS_PORT=1812

# RADIUS shared secret (password between client and server)
RADIUS_SECRET=your_shared_secret

# NAS Identifier (optional, default: authcheck)
RADIUS_NAS_ID=authcheck

# Optional: Request timeout in seconds (default: 10)
# RADIUS_TIMEOUT=10
